#! /bin/bash
set -euo pipefail
SCRIPT_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )

echo "(DEBUG) X509_USER_PROXY=${X509_USER_PROXY}"
echo "(DEBUG) ROOT_DIR=${ROOT_DIR}"
echo "(DEBUG) WORK_DIR=${WORK_DIR}"

source "${ROOT_DIR}"/cicd/gitlab/setupCRABClient.sh

#This file also includes tasks to be checked for CCV
cat <<EOF > "${WORK_DIR}/submitted_tasks_TS"
240814_110745:cmsbot_crab_20240814_130745
240814_110747:cmsbot_crab_20240814_130747
240814_110750:cmsbot_crab_20240814_130749
240814_110752:cmsbot_crab_20240814_130751
240814_110754:cmsbot_crab_20240814_130754
240814_110818:cmsbot_crab_20240814_130756
240814_110821:cmsbot_crab_rucio_transfers_20240814_130820
240814_110823:cmsbot_crab_rucio_transfers_group_20240814_130823
240814_110826:cmsbot_crab_rucio_transfers_manyedm_nopublication_20240814_130825
240814_110829:cmsbot_crab_rucio_transfers_nopublication_20240814_130828
240814_110832:cmsbot_crab_rucio_transfers_withnoneedm_20240814_130830
240814_110834:cmsbot_crab_rucio_transfers_withnoneedm_nopublication_20240814_130833
240904_190936:cmsbot_crab_transferOutputs
240904_190939:cmsbot_crab_transferLogs
240904_190941:cmsbot_crab_activity
240904_190944:cmsbot_crab_inputFiles
240904_190947:cmsbot_crab_disableAutomaticOutputCollection
240904_190949:cmsbot_crab_outputFiles
240904_190952:cmsbot_crab_allowUndistributedCMSSW
240904_190954:cmsbot_crab_maxMemoryMB
240904_190957:cmsbot_crab_maxJobRuntimeMin
240904_190959:cmsbot_crab_numCores
240904_191002:cmsbot_crab_scriptExe
240904_191004:cmsbot_crab_scriptArgs
240904_191007:cmsbot_crab_sendVenvFolder
240904_191010:cmsbot_crab_sendExternalFolder
240904_191012:cmsbot_crab_inputDBS
240904_191015:cmsbot_crab_useParent
240904_191017:cmsbot_crab_secondaryInputDataset
240904_191020:cmsbot_crab_lumiMaskFile
240904_191023:cmsbot_crab_lumiMaskUrl
240904_191026:cmsbot_crab_outLFNDirBase
240904_191029:cmsbot_crab_runRange
240904_191031:cmsbot_crab_ignoreLocality
240904_191034:cmsbot_crab_userInputFiles
240904_191036:cmsbot_crab_whitelist
240904_191039:cmsbot_crab_blacklist
240904_191041:cmsbot_crab_ignoreGlobalBlacklist
240904_191044:cmsbot_crab_voRole
240904_191046:cmsbot_crab_voGroup
240904_191048:cmsbot_crab_scheddName
240904_191051:cmsbot_crab_collector
240904_191053:cmsbot_crab_extraJDL
EOF

python3 "${SCRIPT_DIR}"/statusTracking.py
